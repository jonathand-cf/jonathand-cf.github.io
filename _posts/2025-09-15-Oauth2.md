---
title: "Oauth2 with Supabase or Google Dev"
categories: tutorials
open_new_tab: true
toc_sticky: true
author_profile: false
toc: true
---

This post is under construction and is not complete.

---

This post summarizes two recent OAuth2 implementations: one with Supabase (Discord) using a server-side authorization pattern in a public repository, and one with Google Cloud Console using a client secret stored in a private repository. It describes the implementation approach, contrasts between the two setups, security considerations, and practical recommendations based on lessons learned.

What this post covers

- High-level implementation steps for Supabase (Discord) and Google Cloud (Gmail).
- Key differences between a server-side authorization flow and a client-secret-based flow.
- Secure secret management and repository practices.
- Common pitfalls, troubleshooting tips, and recommended mitigations.

Key contrasts

- Supabase (Discord) + Server-Side Authorization (SSA)
  - No long-lived client secret in the public repo — backend handles token exchange.
  - Better for confidential clients and when code must be public.
  - Requires a secure backend to store refresh tokens and manage sessions.
- Google Cloud (Gmail) + Client Secret in a Private Repo
  - Simpler for development when the repo is private and secrets can be kept out of public view.
  - Increases risk if repository access is compromised — requires strict access controls and secret rotation.
  - Consider using OAuth consent and restricted scopes to minimize exposure.

Security recommendations

- Never commit client secrets or refresh tokens to source control.
- Use environment variables, cloud secret managers (e.g., Google Secret Manager, HashiCorp Vault), or CI/CD secret stores for runtime secrets.
- Limit OAuth scopes to the minimum required and use short-lived tokens where possible.
- Enforce HTTPS for all redirect URIs and API endpoints.
- Implement token rotation and monitor for anomalous usage.
- Apply repository access controls and audit logs for private projects.

## Google Cloud Console

After setting up a project and creating an OAuth client, I set the JavaScript origin and redirect callback URL. For Google OAuth2 you should request only the scopes you need. For non-sensitive login information, use these scopes:

| API | Scope | User-facing description |
| --- | --- | --- |
|  | openid | Associate you with your personal info on Google |
|  |  .../auth/userinfo.email | See your primary Google Account email address |
|  | .../auth/userinfo.profile | See your personal info, including any personal info you've made publicly available |
